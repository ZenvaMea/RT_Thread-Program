# ã€ART-PIã€‘åŸºäºRT-Threadçš„è‚Œç”µä¿¡å·é©±åŠ¨å¤–éª¨éª¼æ‰‹æŒ‡æ§åˆ¶ç³»ç»Ÿ

<div align="center">

![RT-Thread](https://img.shields.io/badge/RT--Thread-5.1.0-blue)
![Platform](https://img.shields.io/badge/Platform-STM32H750-green)
![Board](https://img.shields.io/badge/Board-ART--PI-orange)
![License](https://img.shields.io/badge/License-Apache--2.0-yellow)
![Status](https://img.shields.io/badge/Status-In%20Development-brightgreen)

**åŸºäºRT-Thread RTOSçš„è‚Œç”µä¿¡å·é©±åŠ¨å¤–éª¨éª¼æ‰‹æŒ‡æ§åˆ¶ç³»ç»Ÿ**

[åŠŸèƒ½æ¼”ç¤º](#-æ¼”ç¤ºæ•ˆæœ) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [å‘½ä»¤å‚è€ƒ](å‘½ä»¤å‚è€ƒæ‰‹å†Œ.md) â€¢ [å¼€å‘æ—¥å¿—](å¼€å‘æ—¥å¿—.md)

</div>

---

## ğŸ“– åº”ç”¨å®ç°åŠŸèƒ½

### æ ¸å¿ƒåŠŸèƒ½
æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºRT-Thread RTOSçš„å¤–éª¨éª¼æ‰‹æŒ‡æ§åˆ¶ç³»ç»Ÿï¼Œé€šè¿‡è‚Œç”µä¿¡å·é‡‡é›†é©±åŠ¨4ä¸ªSCSCLèˆµæœºï¼Œå®ç°å¤–éª¨éª¼æ‰‹æŒ‡çš„ç²¾ç¡®æ§åˆ¶ã€‚ç³»ç»Ÿé›†æˆWiFié€šä¿¡ã€ä¸²å£å±æ˜¾ç¤ºã€å®æ—¶èˆµæœºæ§åˆ¶ç­‰åŠŸèƒ½æ¨¡å—ï¼Œé€‚ç”¨äºåº·å¤è¾…åŠ©ã€äººæœºäº¤äº’ç­‰åº”ç”¨åœºæ™¯ã€‚

### å·²å®ç°åŠŸèƒ½ âœ…

#### 1. WiFiæ— çº¿é€šä¿¡æ¨¡å—
- âœ… **ESP32 APæ¨¡å¼è¿æ¥** - è‡ªåŠ¨è¿æ¥åˆ°ESP32_DEVçƒ­ç‚¹
- âœ… **äº‹ä»¶é©±åŠ¨æ¶æ„** - å¼‚æ­¥è¿æ¥çŠ¶æ€ç®¡ç†
- âœ… **IPåœ°å€è‡ªåŠ¨è·å–** - DHCPè‡ªåŠ¨åˆ†é…å’Œæ˜¾ç¤º
- âœ… **å®Œæ•´å‘½ä»¤é›†** - connect_esp32, wifi_join, wifi_leave, wifi_info
- âœ… **å®æ—¶çŠ¶æ€æ›´æ–°** - è¿æ¥/æ–­å¼€è‡ªåŠ¨æ›´æ–°HMIæ˜¾ç¤º

#### 2. æ™ºèƒ½èˆµæœºæ§åˆ¶ç³»ç»Ÿ
- âœ… **åŸºç¡€æ§åˆ¶åŠŸèƒ½**
  - å•èˆµæœºä½ç½®æ§åˆ¶ï¼ˆ0-4095ç²¾åº¦ï¼‰
  - é€Ÿåº¦è°ƒèŠ‚ï¼ˆ4çº§å¯è°ƒï¼‰
  - æ‰­çŸ©å¼€å…³æ§åˆ¶
  - ç´§æ€¥åœæ­¢ä¿æŠ¤

- âœ… **é«˜çº§æ§åˆ¶åŠŸèƒ½**
  - æŒ‰IDç›´æ¥æ§åˆ¶ï¼ˆ0-3ï¼Œå¯¹åº”é£ŸæŒ‡ã€ä¸­æŒ‡ã€æ— åæŒ‡ã€å°æŒ‡ï¼‰
  - å¤šèˆµæœºååŒæ§åˆ¶
  - æ‰¹é‡æ“ä½œæ”¯æŒ
  - æ™ºèƒ½èˆµæœºåˆ‡æ¢ï¼ˆè‡ªåŠ¨è·Ÿè¸ªå½“å‰èˆµæœºï¼Œå‡å°‘HTTPè¯·æ±‚ï¼‰

- âœ… **åŠ¨ä½œç¼–ç¨‹**
  - å¯ç¼–ç¨‹åŠ¨ä½œåºåˆ—
  - é¢„è®¾åŠ¨ä½œåº“ï¼ˆå›ä¸­ä½ã€æ³¢æµªã€ä¾æ¬¡åŠ¨ä½œï¼‰
  - å»¶æ—¶æ§åˆ¶æ”¯æŒ
  - é€Ÿåº¦å¯è°ƒèŠ‚

- âœ… **çº¿ç¨‹å®‰å…¨è®¾è®¡**
  - äº’æ–¥é”ä¿æŠ¤å…±äº«èµ„æº
  - æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨
  - é˜²æ­¢å‘½ä»¤å†²çª

#### 3. HMIä¸²å£å±æ˜¾ç¤ºç³»ç»Ÿ
- âœ… **åŒå‘é€šä¿¡åè®®**
  - STM32â†’ä¸²å£å±ï¼šå‘é€æ˜¾ç¤ºå‘½ä»¤
  - ä¸²å£å±â†’STM32ï¼šæŒ‰é’®/æ»‘å—äº‹ä»¶å›è°ƒ
  - åè®®ï¼šASCIIå‘½ä»¤ + 0xFFÃ—3å¸§å°¾

- âœ… **å®æ—¶ä¿¡æ¯æ˜¾ç¤º**
  - WiFiè¿æ¥çŠ¶æ€ï¼ˆSSIDã€IPåœ°å€ã€ä¿¡å·å¼ºåº¦ï¼‰
  - 4ä¸ªèˆµæœºå®æ—¶ä½ç½®ï¼ˆ0-4095ï¼‰
  - ç³»ç»Ÿä¿¡æ¯ï¼ˆCPUä½¿ç”¨ç‡ã€å†…å­˜ã€è¿è¡Œæ—¶é—´ï¼‰
  - ç”¨æˆ·æ¶ˆæ¯æç¤º

- âœ… **äº‹ä»¶å¤„ç†ç³»ç»Ÿ**
  - ç”¨æˆ·å¯å®šåˆ¶çš„æŒ‰é’®äº‹ä»¶å›è°ƒ
  - æ»‘å—å€¼å˜åŒ–äº‹ä»¶å¤„ç†
  - å®Œæ•´çš„äº‹ä»¶æ¨¡æ¿å’Œä½¿ç”¨ç¤ºä¾‹

- âœ… **é«˜æ•ˆæ•°æ®ç®¡ç†**
  - 500å­—èŠ‚ç¯å½¢ç¼“å†²åŒº
  - ä¸­æ–­å®‰å…¨çš„æ•°æ®å†™å…¥
  - è‡ªåŠ¨å¸§åŒæ­¥å’Œæ ¡éªŒ

#### 4. HTTPå®¢æˆ·ç«¯
- âœ… åŸºäºlwIPçš„Socketå®ç°
- âœ… URLè§£æå’Œä¸»æœºè¿æ¥
- âœ… è¶…æ—¶æ§åˆ¶å’Œé”™è¯¯å¤„ç†
- âœ… ç®€åŒ–æ¥å£å°è£…

### è§„åˆ’ä¸­åŠŸèƒ½ â³

#### é˜¶æ®µ3ï¼šè‚Œç”µä¿¡å·æ§åˆ¶ï¼ˆå³å°†å¼€å§‹ï¼‰
- â³ UARTè‚Œç”µè‡‚ç¯æ•°æ®é‡‡é›†
- â³ å®æ—¶ä¿¡å·æ»¤æ³¢å¤„ç†ï¼ˆç§»åŠ¨å¹³å‡ã€å¡å°”æ›¼æ»¤æ³¢ï¼‰
- â³ è‚Œç”µ-èˆµæœºæ™ºèƒ½æ˜ å°„ç®—æ³•
- â³ å››é€šé“ç‹¬ç«‹æ§åˆ¶
- â³ è‡ªé€‚åº”é˜ˆå€¼æ ¡å‡†ç³»ç»Ÿ

#### é˜¶æ®µ4ï¼šç³»ç»Ÿé›†æˆä¼˜åŒ–
- â³ ä¸‰æ¨¡å¼æ™ºèƒ½åˆ‡æ¢ï¼ˆæ‰‹åŠ¨/è‚Œç”µ/æ¼”ç¤ºï¼‰
- â³ å‚æ•°é…ç½®ç•Œé¢
- â³ æ•°æ®è®°å½•å’Œå›æ”¾
- â³ æ•…éšœè¯Šæ–­å’Œå®‰å…¨ä¿æŠ¤

#### é˜¶æ®µ5ï¼šæµ‹è¯•ä¸å®Œå–„
- â³ å®Œæ•´åŠŸèƒ½æµ‹è¯•
- â³ é•¿æ—¶é—´ç¨³å®šæ€§æµ‹è¯•
- â³ ç”¨æˆ·ä½“éªŒä¼˜åŒ–

---

## ğŸ”§ RT-Threadä½¿ç”¨æƒ…å†µæ¦‚è¿°

### RT-Threadç‰ˆæœ¬
- **å†…æ ¸ç‰ˆæœ¬**: RT-Thread 5.1.0
- **BSP**: STM32H750 ART-PIå¼€å‘æ¿
- **å®˜æ–¹ä»“åº“**: [sdk-bsp-stm32h750-realthread-artpi](https://github.com/RT-Thread-Studio/sdk-bsp-stm32h750-realthread-artpi)

### ä½¿ç”¨çš„RT-Threadç»„ä»¶

#### 1. å†…æ ¸ç»„ä»¶
```
âœ… çº¿ç¨‹ç®¡ç† (Thread)
  - HMIæ¥æ”¶çº¿ç¨‹ (ä¼˜å…ˆçº§15, æ ˆ2KB)
  - ç³»ç»Ÿä¿¡æ¯æ›´æ–°çº¿ç¨‹ (ä¼˜å…ˆçº§20, æ ˆ2KB)
  - ä¸»çº¿ç¨‹

âœ… çº¿ç¨‹åŒæ­¥ (IPC)
  - äº’æ–¥é” (Mutex) - èˆµæœºæ§åˆ¶ä¿æŠ¤
  - ä¿¡å·é‡ (Semaphore) - HMIæ¥æ”¶äº‹ä»¶é€šçŸ¥
  - äº‹ä»¶é›† (Event) - WiFiçŠ¶æ€ç®¡ç†

âœ… å†…å­˜ç®¡ç†
  - åŠ¨æ€å†…å­˜åˆ†é…
  - å†…å­˜æ± ç®¡ç†
```

#### 2. è®¾å¤‡é©±åŠ¨æ¡†æ¶
```
âœ… UARTè®¾å¤‡
  - UART1: HMIä¸²å£å± (115200 baud, ä¸­æ–­æ¥æ”¶)
  - UART4: æ§åˆ¶å° (115200 baud)
  - é…ç½®: RXç¼“å†²512å­—èŠ‚, TXç¼“å†²256å­—èŠ‚

âœ… å®šæ—¶å™¨
  - è½¯ä»¶å®šæ—¶å™¨ç”¨äºå‘¨æœŸæ€§ä»»åŠ¡
```

#### 3. ç½‘ç»œç»„ä»¶
```
âœ… lwIPåè®®æ ˆ
  - TCP/IPå®Œæ•´åè®®æ ˆ
  - Socket API
  - DHCPå®¢æˆ·ç«¯
  - DNSè§£æ

âœ… WiFiæ¡†æ¶
  - WLANç®¡ç†æ¡†æ¶
  - CYW43438é©±åŠ¨
  - STAæ¨¡å¼æ”¯æŒ
  - äº‹ä»¶å›è°ƒæœºåˆ¶
```

#### 4. æ–‡ä»¶ç³»ç»Ÿä¸shell
```
âœ… FinSH/MSH
  - å‘½ä»¤è¡Œäº¤äº’ç•Œé¢
  - è‡ªå®šä¹‰å‘½ä»¤å¯¼å‡º
  - 72ä¸ªäº¤äº’å‘½ä»¤

âœ… è°ƒè¯•ç»„ä»¶
  - ulogæ—¥å¿—ç³»ç»Ÿ
  - æŒ‰æ¨¡å—åˆ†çº§æ—¥å¿— (INFO/WARNING/ERROR/DEBUG)
```

### RT-Threadé…ç½®äº®ç‚¹

#### ç³»ç»Ÿé…ç½®
```c
/* RT-Threadå†…æ ¸é…ç½® */
#define RT_THREAD_PRIORITY_MAX      32    // æœ€å¤§ä¼˜å…ˆçº§
#define RT_TICK_PER_SECOND          1000  // ç³»ç»ŸèŠ‚æ‹1ms
#define RT_USING_OVERFLOW_CHECK           // æ ˆæº¢å‡ºæ£€æµ‹
#define RT_USING_HOOK                     // é’©å­å‡½æ•°

/* è®¾å¤‡é©±åŠ¨é…ç½® */
#define BSP_USING_UART1                   // HMIä¸²å£å±
#define BSP_USING_UART4                   // æ§åˆ¶å°
#define BSP_UART1_RX_BUFSIZE    512       // æ¥æ”¶ç¼“å†²
#define BSP_UART1_TX_BUFSIZE    256       // å‘é€ç¼“å†²

/* ç½‘ç»œé…ç½® */
#define RT_USING_LWIP                     // lwIPåè®®æ ˆ
#define RT_USING_SAL                      // SocketæŠ½è±¡å±‚
#define RT_USING_NETDEV                   // ç½‘ç»œè®¾å¤‡
```

---

## ğŸ—ï¸ ç¡¬ä»¶æ¡†æ¶

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¤–éª¨éª¼æ‰‹æŒ‡æ§åˆ¶ç³»ç»Ÿæ¶æ„                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  è‚Œç”µè‡‚ç¯                ART-PIä¸»æ§           ESP32é©±åŠ¨æ¿
  (ä¼ æ„Ÿå™¨)              (STM32H750)            (WiFi AP)
     â”‚                        â”‚                     â”‚
     â”‚  è‚Œç”µä¿¡å·(UART)         â”‚                     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                     â”‚
     â”‚                        â”‚                     â”‚
     â”‚                        â”‚   WiFiè¿æ¥          â”‚
     â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                        â”‚   HTTPå‘½ä»¤          â”‚
     â”‚                        â”‚                     â”‚
     â”‚                        â”‚                     â”‚  SCSCLåè®®
     â”‚                        â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> èˆµæœº0 (é£ŸæŒ‡)
     â”‚                        â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> èˆµæœº1 (ä¸­æŒ‡)
     â”‚      ä¸²å£å±             â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> èˆµæœº2 (æ— åæŒ‡)
     â”‚    (TJC/è¿ªæ–‡)           â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> èˆµæœº3 (å°æŒ‡)
     â”‚        â”‚                â”‚
     â”‚        â”‚  UART1         â”‚
     â”‚        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚        â”‚   æ˜¾ç¤ºæ•°æ®      â”‚
     â”‚                        â”‚
     â”‚                   ç”µæºä¾›ç”µç³»ç»Ÿ
     â”‚                    (8.4V)
     â”‚                        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                          (å…±åœ°è¿æ¥)
```

### æ ¸å¿ƒç¡¬ä»¶æ¸…å•

#### 1. ART-PIå¼€å‘æ¿
- **èŠ¯ç‰‡å‹å·**: STM32H750XBH6
- **CPUæ¶æ„**: ARM Cortex-M7
- **ä¸»é¢‘**: 400MHzï¼ˆæœ€é«˜å¯è¾¾480MHzï¼‰
- **å†…ç½®Flash**: 128KB
- **å¤–éƒ¨Flash**: 16MB QSPI Flash (W25Q128)
- **å†…ç½®SRAM**: 1MB (512KB DTCM + 512KB AXI SRAM)
- **å¤–éƒ¨SRAM**: 32MB SDRAM
- **WiFiæ¨¡å—**: AP6212 (Broadcom CYW43438)
- **è°ƒè¯•æ¥å£**: ST-Link V2.1
- **å¼€å‘æ¿é“¾æ¥**: [ART-PIå®˜ç½‘](https://art-pi.gitee.io/website/)

#### 2. WiFié€šä¿¡æ¨¡å—
- **èŠ¯ç‰‡**: CYW43438 (AP6212æ¨¡å—)
- **å·¥ä½œé¢‘æ®µ**: 2.4GHz IEEE 802.11 b/g/n
- **å·¥ä½œæ¨¡å¼**: STAæ¨¡å¼ï¼ˆè¿æ¥ESP32 APï¼‰
- **åè®®æ ˆ**: lwIP 2.1.2
- **æ¥å£ç±»å‹**: SDIO
- **é€šä¿¡æ–¹å¼**: HTTPå®¢æˆ·ç«¯

#### 3. èˆµæœºç³»ç»Ÿ
- **å‹å·**: SCSCLä¸²è¡Œæ€»çº¿èˆµæœº Ã— 4
- **ç”µå‹èŒƒå›´**: 6.0V - 8.4V (æ¨è8.4V)
- **é¢å®šç”µå‹**: 8.4V (2Sé”‚ç”µæ± )
- **ä½ç½®ç²¾åº¦**: 0-4095 (12ä½ç²¾åº¦)
- **é€šä¿¡åè®®**: UARTä¸²è¡Œæ€»çº¿
- **æ§åˆ¶æ–¹å¼**: é€šè¿‡ESP32è½¬å‘HTTPå‘½ä»¤
- **åº”ç”¨åˆ†é…**:
  - èˆµæœº0 â†’ é£ŸæŒ‡
  - èˆµæœº1 â†’ ä¸­æŒ‡
  - èˆµæœº2 â†’ æ— åæŒ‡
  - èˆµæœº3 â†’ å°æŒ‡

#### 4. HMIä¸²å£å±
- **å‹å·**: TJC/è¿ªæ–‡ä¸²å£å±
- **æ¥å£**: UART (TTLç”µå¹³)
- **è¿æ¥ç«¯å£**: UART1 (STM32 PA9/PA10)
- **æ³¢ç‰¹ç‡**: 115200 baud
- **æ•°æ®ä½**: 8
- **åœæ­¢ä½**: 1
- **æ ¡éªŒ**: None
- **é€šä¿¡åè®®**: ASCIIå‘½ä»¤ + 0xFFÃ—3å¸§å°¾
- **ä¾›ç”µ**: 5V

#### 5. ESP32é©±åŠ¨æ¿
- **èŠ¯ç‰‡**: ESP32-WROOM-32
- **åŠŸèƒ½**: WiFi AP + èˆµæœºé©±åŠ¨æ¡¥æ¥
- **WiFié…ç½®**:
  - SSID: ESP32_DEV
  - å¯†ç : 12345678
  - IP: 192.168.4.1
- **èˆµæœºæ¥å£**: UARTä¸²å£æ€»çº¿

#### 6. ä¾›ç”µç³»ç»Ÿ
```
12Vç”µæºé€‚é…å™¨
    â”‚
    â”œâ”€â”€> ART-PIä¸»æ¿ (12Vè¾“å…¥, æ¿è½½ç¨³å‹è‡³5V/3.3V)
    â”‚
    â”œâ”€â”€> ESP32é©±åŠ¨æ¿ (5V/3.3V)
    â”‚
    â””â”€â”€> DC-DCé™å‹æ¨¡å— (LM2596/XL4015)
              â”‚
              â””â”€â”€> 8.4Vè¾“å‡º â”€â”€> 4ä¸ªèˆµæœºä¾›ç”µ
                                 (å¹¶è”1000Î¼Fç”µå®¹)

âš ï¸ é‡è¦ï¼šæ‰€æœ‰ç”µæºGNDå¿…é¡»å…±åœ°è¿æ¥
```

### å¼•è„šè¿æ¥è¡¨

| åŠŸèƒ½ | ART-PIå¼•è„š | è¿æ¥è®¾å¤‡ | è¯´æ˜ |
|------|-----------|---------|------|
| **WiFi** | SDIO | CYW43438 | æ¿è½½WiFiæ¨¡å— |
| **ä¸²å£å±** | | | |
| UART1 TX | PA9 | HMI RX | å‘é€æ˜¾ç¤ºå‘½ä»¤ |
| UART1 RX | PA10 | HMI TX | æ¥æ”¶æŒ‰é’®äº‹ä»¶ |
| **æ§åˆ¶å°** | | | |
| UART4 TX | PA0 | USBè½¬ä¸²å£ | MSHå‘½ä»¤è¡Œ |
| UART4 RX | PA1 | USBè½¬ä¸²å£ | è°ƒè¯•è¾“å…¥ |
| **ç”µæº** | | | |
| VCC | 5V | HMI VCC | ä¸²å£å±ä¾›ç”µ |
| GND | GND | æ‰€æœ‰è®¾å¤‡GND | å…±åœ°è¿æ¥ |

---

## ğŸ’» è½¯ä»¶æ¡†æ¶è¯´æ˜

### æ•´ä½“è½¯ä»¶æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åº”ç”¨å±‚ (Applications)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  main.c          â”‚ WiFiç®¡ç† â”‚ èˆµæœºæ§åˆ¶ â”‚ HMIæ˜¾ç¤º        â”‚
â”‚  ç³»ç»Ÿåˆå§‹åŒ–       â”‚ å‘½ä»¤é›†    â”‚ é«˜çº§API  â”‚ äº‹ä»¶å›è°ƒ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸­é—´ä»¶å±‚ (Middleware)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  WiFiç®¡ç†å™¨  â”‚ HTTPå®¢æˆ·ç«¯ â”‚ èˆµæœºæ§åˆ¶å™¨ â”‚ HMIé©±åŠ¨       â”‚
â”‚  çŠ¶æ€æœº      â”‚ Socketå°è£… â”‚ å‘½ä»¤å°è£…   â”‚ åè®®è§£æ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                RT-Threadç»„ä»¶å±‚ (Components)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  lwIPåè®®æ ˆ  â”‚ WLANæ¡†æ¶   â”‚ FinSH/MSH  â”‚ ulogæ—¥å¿—      â”‚
â”‚  TCP/IP      â”‚ WiFié©±åŠ¨   â”‚ å‘½ä»¤è¡Œ     â”‚ è°ƒè¯•è¾“å‡º      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              RT-Threadå†…æ ¸å±‚ (Kernel)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  çº¿ç¨‹è°ƒåº¦    â”‚ IPCæœºåˆ¶    â”‚ å†…å­˜ç®¡ç†   â”‚ è®¾å¤‡é©±åŠ¨æ¡†æ¶  â”‚
â”‚  æ—¶é’Ÿç®¡ç†    â”‚ å®šæ—¶å™¨     â”‚ ä¸­æ–­ç®¡ç†   â”‚ UART/GPIO    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç¡¬ä»¶æŠ½è±¡å±‚ (HAL)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  STM32 HALåº“  â”‚ CMSIS     â”‚ å¯åŠ¨ä»£ç    â”‚ æ—¶é’Ÿé…ç½®      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                STM32H750ç¡¬ä»¶å¹³å°                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çº¿ç¨‹æ¨¡å‹

```
ä¸»çº¿ç¨‹ (main)
  â”‚  ä¼˜å…ˆçº§: é»˜è®¤
  â”‚  æ ˆå¤§å°: é»˜è®¤
  â”‚  åŠŸèƒ½: ç³»ç»Ÿåˆå§‹åŒ–
  â”‚
  â”œâ”€â”€> HMIæ¥æ”¶çº¿ç¨‹ (hmi_rx)
  â”‚      ä¼˜å…ˆçº§: 15
  â”‚      æ ˆå¤§å°: 2048å­—èŠ‚
  â”‚      åŠŸèƒ½: ä¸²å£å±æ•°æ®æ¥æ”¶å’Œå¸§è§£æ
  â”‚      è§¦å‘: ä¿¡å·é‡ï¼ˆUARTä¸­æ–­ï¼‰
  â”‚
  â””â”€â”€> ç³»ç»Ÿä¿¡æ¯çº¿ç¨‹ (sys_info)
         ä¼˜å…ˆçº§: 20
         æ ˆå¤§å°: 2048å­—èŠ‚
         åŠŸèƒ½: å®šæ—¶æ›´æ–°ç³»ç»ŸçŠ¶æ€åˆ°HMI
         å‘¨æœŸ: 1ç§’
```

### æ•°æ®æµå‘

#### 1. WiFiè¿æ¥æµç¨‹
```
ç”¨æˆ·å‘½ä»¤ (connect_esp32)
    â†“
WiFiç®¡ç†å™¨ (wifi_connect)
    â†“
RT-Thread WLANæ¡†æ¶
    â†“
CYW43438é©±åŠ¨
    â†“
WiFiäº‹ä»¶å›è°ƒ (RT_WLAN_EVT_READY)
    â†“
æ›´æ–°HMIæ˜¾ç¤º (hmi_update_wifi_status)
```

#### 2. èˆµæœºæ§åˆ¶æµç¨‹
```
ç”¨æˆ·å‘½ä»¤ (serv move 0 0 2)
    â†“
èˆµæœºé«˜çº§API (servo_move_by_id_speed)
    â†“
äº’æ–¥é”ä¿æŠ¤
    â†“
åˆ‡æ¢åˆ°ç›®æ ‡èˆµæœº (switch_to_servo)
    â†“
HTTPå®¢æˆ·ç«¯ (http_get_simple)
    â†“
lwIP Socket
    â†“
WiFiå‘é€åˆ°ESP32
    â†“
ESP32æ§åˆ¶èˆµæœº
    â†“
æ›´æ–°HMIæ˜¾ç¤º (hmi_update_servo_pos)
```

#### 3. HMIäº‹ä»¶å¤„ç†æµç¨‹
```
ä¸²å£å±æŒ‰é’®ç‚¹å‡»
    â†“
UART1ä¸­æ–­æ¥æ”¶
    â†“
ç¯å½¢ç¼“å†²åŒºå†™å…¥
    â†“
ä¿¡å·é‡é‡Šæ”¾
    â†“
HMIæ¥æ”¶çº¿ç¨‹å”¤é†’
    â†“
å¸§è§£æ (0x55 + cmd + data + 0xFFÃ—3)
    â†“
äº‹ä»¶å›è°ƒ (hmi_on_button_click)
    â†“
æ‰§è¡Œèˆµæœºæ§åˆ¶
```

---

## ğŸ“¦ è½¯ä»¶æ¨¡å—è¯´æ˜

### 1. WiFiç®¡ç†æ¨¡å— (wifi_manager.c/h)

**åŠŸèƒ½**: WiFiè¿æ¥ç®¡ç†å’ŒçŠ¶æ€ç»´æŠ¤

**å…³é”®API**:
```c
int wifi_manager_init(void);                              // åˆå§‹åŒ–WiFiç®¡ç†å™¨
int wifi_connect(const char *ssid, const char *password); // è¿æ¥WiFi
int wifi_disconnect(void);                                // æ–­å¼€WiFi
wifi_status_t wifi_get_status(void);                      // è·å–è¿æ¥çŠ¶æ€
int wifi_get_ip(char *ip_buf, int buf_len);               // è·å–IPåœ°å€
int wifi_wait_ready(int timeout_ms);                      // ç­‰å¾…è¿æ¥æˆåŠŸ
```

**MSHå‘½ä»¤**:
- `connect_esp32` - å¿«é€Ÿè¿æ¥ESP32_DEV
- `wifi_join <ssid> [password]` - è¿æ¥ä»»æ„WiFi
- `wifi_leave` - æ–­å¼€è¿æ¥
- `wifi_info` - æŸ¥çœ‹è¯¦ç»†çŠ¶æ€

**è®¾è®¡ç‰¹ç‚¹**:
- äº‹ä»¶é©±åŠ¨çŠ¶æ€æœº
- å¼‚æ­¥è¿æ¥å¤„ç†
- è‡ªåŠ¨IPè·å–
- HMIå®æ—¶æ›´æ–°

---

### 2. HTTPå®¢æˆ·ç«¯æ¨¡å— (servo_http_client.c/h)

**åŠŸèƒ½**: HTTP GETè¯·æ±‚å°è£…

**å…³é”®API**:
```c
int http_client_init(void);                               // åˆå§‹åŒ–å®¢æˆ·ç«¯
int http_get(const char *url, http_response_t *response,  // HTTP GET
             int timeout_ms);
int http_get_simple(const char *url);                     // ç®€åŒ–æ¥å£
```

**å®ç°ç»†èŠ‚**:
- åŸºäºlwIP Socket
- URLè‡ªåŠ¨è§£æï¼ˆä¸»æœºåã€ç«¯å£ã€è·¯å¾„ï¼‰
- è¶…æ—¶æ§åˆ¶ï¼ˆé»˜è®¤10ç§’ï¼‰
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

---

### 3. åŸºç¡€èˆµæœºæ§åˆ¶æ¨¡å— (servo_control.c/h)

**åŠŸèƒ½**: ESP32 HTTPæ¥å£å°è£…

**å…³é”®API**:
```c
int servo_control_init(const char *server_ip);  // åˆå§‹åŒ–ï¼ˆé»˜è®¤192.168.4.1ï¼‰
int servo_move_middle(void);                    // ç§»åŠ¨åˆ°ä¸­é—´
int servo_move_max(void);                       // ç§»åŠ¨åˆ°æœ€å¤§
int servo_move_min(void);                       // ç§»åŠ¨åˆ°æœ€å°
int servo_stop(void);                           // åœæ­¢
int servo_set_speed(int increase);              // é€Ÿåº¦è°ƒèŠ‚
int servo_select_next(int direction);           // åˆ‡æ¢èˆµæœº
int servo_enable_torque(int enable);            // æ‰­çŸ©å¼€å…³
```

**HTTPå‘½ä»¤æ˜ å°„**:
```
servo_move_middle()  â†’ GET http://192.168.4.1/cmd?type=middle
servo_move_max()     â†’ GET http://192.168.4.1/cmd?type=max
servo_stop()         â†’ GET http://192.168.4.1/cmd?type=stop
```

---

### 4. é«˜çº§èˆµæœºæ§åˆ¶æ¨¡å— (servo_advanced.c/h)

**åŠŸèƒ½**: å¤šèˆµæœºååŒæ§åˆ¶

**å…³é”®æ•°æ®ç»“æ„**:
```c
// åŠ¨ä½œå®šä¹‰
typedef struct {
    int servo_id;      // èˆµæœºID (0-3)
    int position;      // ä½ç½® (0=ä¸­é—´, 1=æœ€å¤§, 2=æœ€å°)
    int speed;         // é€Ÿåº¦ (1-4)
    int delay_ms;      // å»¶æ—¶ (æ¯«ç§’)
} servo_action_t;

// èˆµæœºç»„å®šä¹‰
typedef struct {
    int servo_ids[4];  // èˆµæœºIDæ•°ç»„
    int positions[4];  // ä½ç½®æ•°ç»„
    int count;         // èˆµæœºæ•°é‡
    int speed;         // ç»Ÿä¸€é€Ÿåº¦
} servo_group_t;
```

**å…³é”®API**:
```c
// æŒ‰IDæ§åˆ¶
int servo_move_by_id_speed(int servo_id, int position, int speed);

// å…¨èˆµæœºæ§åˆ¶
int servo_all_middle_speed(int speed);
int servo_all_stop(void);
int servo_all_torque(int enable);
int servo_all_set_speed(int speed);

// æ‰¹é‡æ§åˆ¶
int servo_multi_move_speed(int *servo_ids, int *positions,
                           int *speeds, int count);

// åŠ¨ä½œåºåˆ—
int servo_execute_sequence(servo_action_t *actions, int count);

// é¢„è®¾åŠ¨ä½œ
int servo_preset_home(void);                      // å›ä¸­ä½
int servo_preset_wave(int cycles, int speed);     // æ³¢æµªåŠ¨ä½œ
int servo_preset_sequence(int speed);             // ä¾æ¬¡åŠ¨ä½œ
```

**MSHå‘½ä»¤**:
- `serv move <id> <pos> [speed]` - æ§åˆ¶å•ä¸ªèˆµæœº
- `serv all_mid [speed]` - æ‰€æœ‰èˆµæœºå›ä¸­ä½
- `serv all_stop` - åœæ­¢æ‰€æœ‰
- `serv all_ton/toff` - æ‰­çŸ©å¼€å…³
- `serv multi <ids> <positions>` - æ‰¹é‡æ§åˆ¶
- `serv wave <cycles> [speed]` - æ³¢æµªåŠ¨ä½œ
- `servo_test` - è‡ªåŠ¨æµ‹è¯•

**è®¾è®¡ç‰¹ç‚¹**:
- æ™ºèƒ½èˆµæœºåˆ‡æ¢ï¼ˆè‡ªåŠ¨è·Ÿè¸ªå½“å‰IDï¼‰
- çº¿ç¨‹å®‰å…¨ï¼ˆäº’æ–¥é”ä¿æŠ¤ï¼‰
- 4çº§é€Ÿåº¦æ§åˆ¶
- åŠ¨ä½œåºåˆ—æ”¯æŒ
- HMIä½ç½®è‡ªåŠ¨æ›´æ–°

---

### 5. HMIæ˜¾ç¤ºé©±åŠ¨æ¨¡å— (hmi_display.c/h)

**åŠŸèƒ½**: TJC/è¿ªæ–‡ä¸²å£å±åŒå‘é€šä¿¡

**åè®®æ ¼å¼**:

å‘é€ï¼ˆSTM32â†’ä¸²å£å±ï¼‰:
```
å‘½ä»¤å­—ç¬¦ä¸² + 0xFF + 0xFF + 0xFF

ç¤ºä¾‹ï¼š
"t0.txt=\"Hello\"" + 0xFF + 0xFF + 0xFF
"n0.val=2048" + 0xFF + 0xFF + 0xFF
```

æ¥æ”¶ï¼ˆä¸²å£å±â†’STM32ï¼‰:
```
å¸§æ ¼å¼ï¼š7å­—èŠ‚å›ºå®šé•¿åº¦
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ 0x55 â”‚ cmd_typeâ”‚ data2  â”‚ data3  â”‚ 0xFF â”‚ 0xFF â”‚ 0xFF â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

å‘½ä»¤ç±»å‹ï¼š
  0x01 - æŒ‰é’®ç‚¹å‡»äº‹ä»¶
  0x02 - æ»‘å—h0å€¼å˜åŒ–
  0x03 - æ»‘å—h1å€¼å˜åŒ–
```

**å…³é”®API**:
```c
// åˆå§‹åŒ–
int hmi_init(void);                    // åˆå§‹åŒ–UARTå’Œç¼“å†²åŒº
int hmi_start_thread(void);            // å¯åŠ¨æ¥æ”¶çº¿ç¨‹

// åŸºç¡€é€šä¿¡
int hmi_send_string(const char *str);  // å‘é€å‘½ä»¤
int hmi_set_text(const char *obj_name, const char *text);
int hmi_set_value(const char *obj_name, int value);

// é«˜çº§æ›´æ–°
void hmi_update_wifi_status(const char *ssid, const char *ip, int rssi);
void hmi_update_servo_pos(int servo_id, int position);
void hmi_update_cpu_usage(int percent);
void hmi_update_memory_info(int used_kb, int total_kb);
void hmi_update_runtime(int seconds);
```

**æ§ä»¶æ˜ å°„è¡¨**:
| åŠŸèƒ½ | æ§ä»¶åç§° | ç±»å‹ | è¯´æ˜ |
|------|---------|------|------|
| WiFiçŠ¶æ€ | t_wifi | Text | SSIDæˆ–"Disconnected" |
| IPåœ°å€ | t_ip | Text | 192.168.x.x |
| ä¿¡å·å¼ºåº¦ | n_rssi | Number | -xx dBm |
| èˆµæœº1-4ä½ç½® | n_servo1~4 | Number | 0-4095 |
| èˆµæœº1-4é€Ÿåº¦ | h_speed1~4 | Slider | 0-255 |
| CPUä½¿ç”¨ç‡ | t_cpu | Text | "CPU: xx%" |
| å†…å­˜ä¿¡æ¯ | t_mem | Text | "Mem: xxx/xxx KB" |
| è¿è¡Œæ—¶é—´ | t_time | Text | "HH:MM:SS" |
| æ¶ˆæ¯æ–‡æœ¬ | t_msg | Text | æç¤ºä¿¡æ¯ |

**ç¯å½¢ç¼“å†²åŒº**:
```c
typedef struct {
    uint16_t head;           // è¯»æŒ‡é’ˆ
    uint16_t tail;           // å†™æŒ‡é’ˆ
    uint16_t length;         // å½“å‰é•¿åº¦
    uint8_t data[500];       // ç¼“å†²åŒº
} hmi_ringbuffer_t;
```

**è®¾è®¡ç‰¹ç‚¹**:
- UARTä¸­æ–­æ¥æ”¶
- ç¯å½¢ç¼“å†²åŒºï¼ˆ500å­—èŠ‚ï¼‰
- å¸§å¤´å¸§å°¾åŒé‡éªŒè¯
- ä¿¡å·é‡äº‹ä»¶é€šçŸ¥
- ç‹¬ç«‹æ¥æ”¶çº¿ç¨‹

---

### 6. HMIäº‹ä»¶å›è°ƒæ¨¡å— (hmi_callbacks.c)

**åŠŸèƒ½**: ç”¨æˆ·è‡ªå®šä¹‰äº‹ä»¶å¤„ç†æ¨¡æ¿

**å›è°ƒå‡½æ•°**:
```c
// æŒ‰é’®ç‚¹å‡»å›è°ƒ
void hmi_on_button_click(int button_id, int state);

// æ»‘å—å˜åŒ–å›è°ƒ
void hmi_on_slider_change(int slider_id, int value);
```

**ä½¿ç”¨ç¤ºä¾‹**:
```c
void hmi_on_button_click(int button_id, int state)
{
    if (state != 1) return;  // åªå¤„ç†æŒ‰ä¸‹äº‹ä»¶

    switch (button_id)
    {
        case 1:  // èˆµæœº1æ§åˆ¶æŒ‰é’®
            servo_move_by_id_speed(1, SERVO_POS_MIDDLE, SERVO_SPEED_MEDIUM);
            hmi_set_text("t_msg", "Servo 1 -> Mid");
            break;

        case 10:  // å›ä¸­æŒ‰é’®
            servo_preset_home();
            hmi_set_text("t_msg", "All Servos Home");
            break;
    }
}
```

---

## ğŸ¬ æ¼”ç¤ºæ•ˆæœ

### åŠŸèƒ½æ¼”ç¤ºè§†é¢‘

> ğŸ“¹ **æ¼”ç¤ºè§†é¢‘é“¾æ¥**: [å¾…ä¸Šä¼ ]

### åŠŸèƒ½æ¼”ç¤ºæˆªå›¾

#### 1. WiFiè¿æ¥æ¼”ç¤º
```shell
msh /> connect_esp32
[I/wifi.mgr] Connecting to ESP32 AP...
[I/wifi.mgr] SSID: ESP32_DEV
[I/wifi.mgr] Waiting for WiFi ready (30s timeout)...
[I/wifi.mgr] WiFi connected successfully!
[I/wifi.mgr] IP Address: 192.168.4.10

msh /> wifi_info
========== WiFi Status ==========
Status: Connected
SSID: ESP32_DEV
BSSID: 24:0A:C4:12:34:56
RSSI: -45 dBm
Channel: 1
IP Address: 192.168.4.10
=================================
```

#### 2. èˆµæœºæ§åˆ¶æ¼”ç¤º
```shell
# å•ä¸ªèˆµæœºæ§åˆ¶
msh /> serv move 0 0 2
[I/servo.adv] Servo 0 moved to position 0 (speed: 2)

# æ‰€æœ‰èˆµæœºå›ä¸­ä½
msh /> serv all_mid 3
[I/servo.adv] Moving all servos to middle position (speed: 3)

# æ³¢æµªåŠ¨ä½œæ¼”ç¤º
msh /> serv wave 3 2
[I/servo.adv] Executing preset: WAVE (cycles: 3, speed: 2)
[I/servo.adv] Sequence execution completed

# è‡ªåŠ¨æµ‹è¯•
msh /> servo_test
========== Servo Test ==========
Testing individual servo control...
  âœ“ Servo 0 test passed
  âœ“ Servo 1 test passed
  âœ“ Servo 2 test passed
  âœ“ Servo 3 test passed
Testing all servos control...
  âœ“ All middle test passed
  âœ“ All stop test passed
Testing multi-servo control...
  âœ“ Multi-move test passed
========== Test Complete ==========
```

#### 3. HMIæ˜¾ç¤ºæ¼”ç¤º
```shell
# æµ‹è¯•WiFiæ˜¾ç¤º
msh /> hmi_test wifi
WiFi status updated

# æµ‹è¯•èˆµæœºæ˜¾ç¤º
msh /> hmi_test servo 1 2048
Servo 1 position = 2048

# æµ‹è¯•ç³»ç»Ÿä¿¡æ¯
msh /> hmi_test system
System info updated
```

### ç³»ç»Ÿè¿è¡Œæ•ˆæœ

#### HMIä¸²å£å±å®æ—¶æ˜¾ç¤º
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¤–éª¨éª¼æ‰‹æŒ‡æ§åˆ¶ç³»ç»Ÿ v1.0     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ WiFi: â—å·²è¿æ¥ ESP32_DEV     â”‚
â”‚ IP: 192.168.4.10            â”‚
â”‚                             â”‚
â”‚ èˆµæœºçŠ¶æ€:                    â”‚
â”‚  [é£ŸæŒ‡  ] â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%    â”‚
â”‚  [ä¸­æŒ‡  ] â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60%    â”‚
â”‚  [æ— åæŒ‡] â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 40%    â”‚
â”‚  [å°æŒ‡  ] â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20%    â”‚
â”‚                             â”‚
â”‚ ç³»ç»Ÿ: è¿è¡Œæ­£å¸¸              â”‚
â”‚ CPU: 15%  Mem: 128/456 KB   â”‚
â”‚ è¿è¡Œæ—¶é—´: 01:23:45          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ€§èƒ½æ•°æ®

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| WiFiè¿æ¥æ—¶é—´ | <5ç§’ | ESP32_DEVçƒ­ç‚¹ |
| èˆµæœºå“åº”å»¶è¿Ÿ | <200ms | HTTPè¯·æ±‚å¾€è¿” |
| HMIåˆ·æ–°ç‡ | 10Hz | ç³»ç»Ÿä¿¡æ¯æ›´æ–° |
| CPUå ç”¨ç‡ | <20% | æ‰€æœ‰çº¿ç¨‹è¿è¡Œæ—¶ |
| å†…å­˜ä½¿ç”¨ | ~150KB | åŒ…å«æ‰€æœ‰ç¼“å†²åŒº |
| çº¿ç¨‹æ•°é‡ | 3ä¸ª | main + hmi_rx + sys_info |

---

## ğŸ“¥ ä»£ç åœ°å€

### GitHubä»“åº“
- **é¡¹ç›®åœ°å€**: https://github.com/ZenvaMea/RT_Thread-Program
- **åˆ†æ”¯**: master
- **é¡¹ç›®ç›®å½•**: `/Cc`

### å…‹éš†é¡¹ç›®
```bash
# HTTPSæ–¹å¼
git clone https://github.com/ZenvaMea/RT_Thread-Program.git

# SSHæ–¹å¼ï¼ˆéœ€è¦é…ç½®SSHå¯†é’¥ï¼‰
git clone git@github.com:ZenvaMea/RT_Thread-Program.git

# è¿›å…¥é¡¹ç›®ç›®å½•
cd RT_Thread-Program/Cc
```

### é¡¹ç›®æ–‡ä»¶ç»“æ„
```
Cc/
â”œâ”€â”€ applications/              # åº”ç”¨å±‚ä»£ç 
â”‚   â”œâ”€â”€ main.c                # ä¸»ç¨‹åºï¼ˆç³»ç»Ÿåˆå§‹åŒ–ï¼‰
â”‚   â”œâ”€â”€ wifi_manager.c/h      # WiFiç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ servo_http_client.c/h # HTTPå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ servo_control.c/h     # åŸºç¡€èˆµæœºæ§åˆ¶
â”‚   â”œâ”€â”€ servo_advanced.c/h    # é«˜çº§èˆµæœºæ§åˆ¶
â”‚   â”œâ”€â”€ servo_msh_advanced.c  # èˆµæœºMSHå‘½ä»¤
â”‚   â”œâ”€â”€ hmi_display.c/h       # HMIæ˜¾ç¤ºé©±åŠ¨
â”‚   â””â”€â”€ hmi_callbacks.c       # HMIäº‹ä»¶å›è°ƒæ¨¡æ¿
â”‚
â”œâ”€â”€ board/                    # æ¿çº§æ”¯æŒåŒ…
â”‚   â”œâ”€â”€ board.h               # å¼•è„šå®šä¹‰
â”‚   â”œâ”€â”€ board.c               # æ¿çº§åˆå§‹åŒ–
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ rtconfig.h                # RT-Threadé…ç½®æ–‡ä»¶
â”œâ”€â”€ USART HMI/                # ä¸²å£å±å·¥ç¨‹æ–‡ä»¶
â”‚   â”œâ”€â”€ demo1.HMI            # ä¸²å£å±å·¥ç¨‹
â”‚   â”œâ”€â”€ Cc.zi                # å­—åº“æ–‡ä»¶
â”‚   â””â”€â”€ *.png                # ç•Œé¢å›¾ç‰‡
â”‚
â”œâ”€â”€ å‘½ä»¤å‚è€ƒæ‰‹å†Œ.md            # 72ä¸ªå‘½ä»¤è¯¦ç»†æ–‡æ¡£
â”œâ”€â”€ å¼€å‘æ—¥å¿—.md               # å®Œæ•´å¼€å‘è®°å½•
â””â”€â”€ README.md                 # æœ¬æ–‡ä»¶
```

### å‚è€ƒæ–‡æ¡£
- **å‘½ä»¤æ‰‹å†Œ**: [å‘½ä»¤å‚è€ƒæ‰‹å†Œ.md](å‘½ä»¤å‚è€ƒæ‰‹å†Œ.md) - 72ä¸ªäº¤äº’å‘½ä»¤å®Œæ•´è¯´æ˜
- **å¼€å‘æ—¥å¿—**: [å¼€å‘æ—¥å¿—.md](å¼€å‘æ—¥å¿—.md) - è¯¦ç»†çš„å¼€å‘è¿‡ç¨‹å’ŒæŠ€æœ¯è¦ç‚¹
- **ART-PIå®˜æ–¹æ–‡æ¡£**: https://art-pi.gitee.io/website/
- **RT-Threadæ–‡æ¡£ä¸­å¿ƒ**: https://www.rt-thread.org/document/site/

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¡¬ä»¶å‡†å¤‡

#### å¿…éœ€ç¡¬ä»¶
- âœ… ART-PIå¼€å‘æ¿ Ã— 1
- âœ… ESP32é©±åŠ¨æ¿ Ã— 1
- âœ… SCSCLèˆµæœº Ã— 4
- âœ… TJC/è¿ªæ–‡ä¸²å£å± Ã— 1
- âœ… DC-DCé™å‹æ¨¡å—ï¼ˆLM2596/XL4015ï¼‰ Ã— 1
- âœ… 12Vç”µæºé€‚é…å™¨ï¼ˆ3Aä»¥ä¸Šï¼‰ Ã— 1
- âœ… æœé‚¦çº¿è‹¥å¹²

#### ç¡¬ä»¶è¿æ¥
```
ã€èˆµæœºä¾›ç”µã€‘
12Vç”µæº â†’ DC-DCé™å‹æ¨¡å— â†’ è°ƒèŠ‚è‡³8.4V â†’ èˆµæœºVCC
                                      â†“
                                     GND â†’ å…±åœ°

ã€ä¸²å£å±è¿æ¥ã€‘
ART-PI PA9  â†’ ä¸²å£å± RX
ART-PI PA10 â† ä¸²å£å± TX
ART-PI GND  â†’ ä¸²å£å± GND
ART-PI 5V   â†’ ä¸²å£å± VCC

ã€WiFiã€‘
æ¿è½½AP6212æ¨¡å—ï¼Œæ— éœ€å¤–æ¥

âš ï¸ é‡è¦ï¼šæ‰€æœ‰GNDå¿…é¡»å…±åœ°è¿æ¥ï¼
```

### 2. è½¯ä»¶å‡†å¤‡

#### å¼€å‘ç¯å¢ƒ
- **RT-Thread Studio** æˆ– **MDK-ARM Keil**
- **RT-Thread 5.1.0**
- **Git**
- **ST-Linké©±åŠ¨**

#### ä¸‹è½½ä»£ç 
```bash
git clone https://github.com/ZenvaMea/RT_Thread-Program.git
cd RT_Thread-Program/Cc
```

### 3. ç¼–è¯‘ä¸‹è½½

#### ä½¿ç”¨RT-Thread Studio
1. æ‰“å¼€RT-Thread Studio
2. File â†’ Import â†’ General â†’ Existing Projects into Workspace
3. é€‰æ‹©`Cc`ç›®å½•
4. å³é”®é¡¹ç›® â†’ Build Project
5. å³é”®é¡¹ç›® â†’ Debug As â†’ RT-Thread Studio Debug
6. ä¸‹è½½åˆ°ART-PIå¼€å‘æ¿

#### ä½¿ç”¨MDK-ARM
1. æ‰“å¼€Keil uVision5
2. Project â†’ Open Project
3. é€‰æ‹©`project.uvprojx`
4. Project â†’ Build Target (F7)
5. Flash â†’ Download (F8)

### 4. é…ç½®ESP32

ç¡®ä¿ESP32é©±åŠ¨æ¿é…ç½®å¦‚ä¸‹ï¼š
- WiFi APæ¨¡å¼
- SSID: `ESP32_DEV`
- å¯†ç : `12345678`
- IPåœ°å€: `192.168.4.1`

### 5. å¼€å§‹ä½¿ç”¨

#### è¿æ¥WiFi
```shell
msh /> connect_esp32
[I/wifi.mgr] WiFi connected successfully!
[I/wifi.mgr] IP Address: 192.168.4.10
```

#### æµ‹è¯•èˆµæœº
```shell
# å•ä¸ªèˆµæœºæµ‹è¯•
msh /> serv move 0 0 2

# æ‰€æœ‰èˆµæœºå›ä¸­ä½
msh /> serv all_mid 3

# å®Œæ•´åŠŸèƒ½æµ‹è¯•
msh /> servo_test
```

#### æŸ¥çœ‹å¸®åŠ©
```shell
msh /> help        # æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤
msh /> wifi_info   # æŸ¥çœ‹WiFiçŠ¶æ€
msh /> list_thread # æŸ¥çœ‹çº¿ç¨‹çŠ¶æ€
msh /> free        # æŸ¥çœ‹å†…å­˜ä½¿ç”¨
```

---

## âš ï¸ é‡è¦æç¤º

### ç¡¬ä»¶å®‰å…¨

1. **ç”µå‹åŒ¹é…** âš¡
   - èˆµæœºé¢å®šç”µå‹ï¼š**8.4V**
   - **ç¦æ­¢ç›´æ¥12Vä¾›ç”µï¼**
   - å¿…é¡»ä½¿ç”¨DC-DCé™å‹æ¨¡å—
   - ç©ºè½½è°ƒèŠ‚è‡³8.4Vï¼Œå¸¦è½½ç”µå‹â‰¥8.0V

2. **ç”µæµå®¹é‡** ğŸ”Œ
   - 4ä¸ªèˆµæœºå³°å€¼ç”µæµï¼šçº¦5A
   - æ¨èç”µæºï¼š12V/3Aä»¥ä¸Š
   - é™å‹æ¨¡å—ï¼š5Aè¾“å‡ºèƒ½åŠ›
   - ä½¿ç”¨ç²—çº¿ä¾›ç”µï¼ˆâ‰¥20AWGï¼‰

3. **å…±åœ°è¿æ¥** ğŸ”—
   - æ‰€æœ‰ç”µæºGNDå¿…é¡»è¿æ¥
   - ART-PIã€ESP32ã€èˆµæœºã€ä¸²å£å±å…±åœ°
   - èˆµæœºç”µæºç«¯å¹¶è”1000Î¼Fç”µå®¹

4. **å®šæœŸæ£€æŸ¥** ğŸ”
   - æµ‹é‡èˆµæœºç”µå‹ï¼ˆä¸‡ç”¨è¡¨ï¼‰
   - è§‚å¯Ÿèˆµæœºæ¸©åº¦ï¼ˆæ‰‹æ„Ÿï¼Œåº”â‰¤40â„ƒï¼‰
   - æ£€æŸ¥æ¥çº¿ç«¯å­æ˜¯å¦æ¾åŠ¨

### è½¯ä»¶ä½¿ç”¨

1. **WiFiä¼˜å…ˆ** ğŸ“¡
   - æ‰€æœ‰èˆµæœºå‘½ä»¤éœ€å…ˆè¿æ¥WiFi
   - ä½¿ç”¨`connect_esp32`å¿«é€Ÿè¿æ¥
   - æ–­å¼€åéœ€é‡æ–°è¿æ¥

2. **æ‰­çŸ©ç®¡ç†** ğŸ›¡ï¸
   - é•¿æ—¶é—´ä¸ç”¨å»ºè®®å…³é—­æ‰­çŸ©ï¼š`serv all_toff`
   - é¿å…èˆµæœºè¿‡çƒ­å’Œè€—ç”µ
   - ä½¿ç”¨å‰æ‰“å¼€æ‰­çŸ©ï¼š`serv all_ton`

3. **ç´§æ€¥åœæ­¢** ğŸ›‘
   - é‡åˆ°å¼‚å¸¸ç«‹å³ï¼š`serv all_stop`
   - æ£€æŸ¥ç¡¬ä»¶è¿æ¥å’Œç”µæº
   - å¿…è¦æ—¶æ–­å¼€ç”µæº

---

## ğŸ“Š å¼€å‘è¿›åº¦

### é‡Œç¨‹ç¢‘

- âœ… **é‡Œç¨‹ç¢‘1**: WiFièˆµæœºæ§åˆ¶åŸºç¡€åŠŸèƒ½ï¼ˆ2025-11-14å®Œæˆï¼‰
- âœ… **é‡Œç¨‹ç¢‘2**: ä¸²å£å±æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€ï¼ˆ2025-11-15å®Œæˆï¼‰
- ğŸ¯ **é‡Œç¨‹ç¢‘3**: è‚Œç”µä¿¡å·å®æ—¶æ§åˆ¶å•æ‰‹æŒ‡
- ğŸ¯ **é‡Œç¨‹ç¢‘4**: å››æŒ‡ç‹¬ç«‹æ§åˆ¶
- ğŸ¯ **é‡Œç¨‹ç¢‘5**: å®Œæ•´ç³»ç»Ÿæ¼”ç¤º

### æ—¶é—´è½´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   é¡¹ç›®æ—¶é—´è½´                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é˜¶æ®µ1: WiFièˆµæœºæ§åˆ¶        â”‚ âœ… å·²å®Œæˆ (2025-11-14)  â”‚
â”‚ é˜¶æ®µ2: ä¸²å£å±æ˜¾ç¤º          â”‚ âœ… å·²å®Œæˆ (2025-11-15)  â”‚
â”‚ é˜¶æ®µ3: è‚Œç”µä¿¡å·æ§åˆ¶        â”‚ â³ å³å°†å¼€å§‹             â”‚
â”‚ é˜¶æ®µ4: ç³»ç»Ÿé›†æˆä¼˜åŒ–        â”‚ â³                     â”‚
â”‚ é˜¶æ®µ5: æµ‹è¯•ä¸å®Œå–„          â”‚ â³                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¢„è®¡æ€»å·¥æœŸ: 2-3å‘¨                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº **Apache-2.0** è®¸å¯è¯å¼€æºã€‚

---

## ğŸ‘¨â€ğŸ’» ä½œè€…

**Cc**

- GitHub: [@ZenvaMea](https://github.com/ZenvaMea)
- é¡¹ç›®ä»“åº“: [RT_Thread-Program](https://github.com/ZenvaMea/RT_Thread-Program)

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **GitHub Issues**: [æäº¤é—®é¢˜](https://github.com/ZenvaMea/RT_Thread-Program/issues)
- **å‚è€ƒæ–‡æ¡£**:
  - [å‘½ä»¤å‚è€ƒæ‰‹å†Œ.md](å‘½ä»¤å‚è€ƒæ‰‹å†Œ.md)
  - [å¼€å‘æ—¥å¿—.md](å¼€å‘æ—¥å¿—.md)
- **ART-PIç¤¾åŒº**: https://art-pi.gitee.io/website/

---

## ğŸ™ è‡´è°¢

- [RT-Thread](https://www.rt-thread.org/) - ä¼˜ç§€çš„å›½äº§RTOS
- [ART-PIå›¢é˜Ÿ](https://art-pi.gitee.io/website/) - ART-PIå¼€å‘æ¿
- [STMicroelectronics](https://www.st.com/) - STM32H750èŠ¯ç‰‡
- [Espressif](https://www.espressif.com/) - ESP32 WiFiæ¨¡å—
- æ‰€æœ‰ä¸ºå¼€æºç¤¾åŒºåšå‡ºè´¡çŒ®çš„å¼€å‘è€…

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªStarï¼â­**

Made with â¤ï¸ by Cc

Â© 2025 RT-Threadå¤–éª¨éª¼æ‰‹æŒ‡æ§åˆ¶ç³»ç»Ÿ

</div>
